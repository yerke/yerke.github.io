<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Preface - The Embedonomicon</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="preface.html" class="active">Preface</a></li><li class="chapter-item expanded "><a href="smallest-no-std.html"><strong aria-hidden="true">1.</strong> The smallest #![no_std] program</a></li><li class="chapter-item expanded "><a href="memory-layout.html"><strong aria-hidden="true">2.</strong> Memory layout</a></li><li class="chapter-item expanded "><a href="main.html"><strong aria-hidden="true">3.</strong> A main interface</a></li><li class="chapter-item expanded "><a href="exceptions.html"><strong aria-hidden="true">4.</strong> Exception handling</a></li><li class="chapter-item expanded "><a href="asm.html"><strong aria-hidden="true">5.</strong> Assembly on stable</a></li><li class="chapter-item expanded "><a href="logging.html"><strong aria-hidden="true">6.</strong> Logging with symbols</a></li><li class="chapter-item expanded "><a href="singleton.html"><strong aria-hidden="true">7.</strong> Global singletons</a></li><li class="chapter-item expanded "><a href="dma.html"><strong aria-hidden="true">8.</strong> DMA</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="compiler-support.html">A note on compiler support</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The Embedonomicon</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#the-embedonomicon" id="the-embedonomicon">The embedonomicon</a></h1>
<p>The embedonomicon walks you through the process of creating a <code>#![no_std]</code> application from scratch
and through the iterative process of building architecture-specific functionality for Cortex-M
microcontrollers.</p>
<h2><a class="header" href="#objectives" id="objectives">Objectives</a></h2>
<p>By reading this book you will learn</p>
<ul>
<li>
<p>How to build a <code>#![no_std]</code> application. This is much more complex than building a <code>#![no_std]</code>
library because the target system may not be running an OS (or you could be aiming to build an
OS!) and the program could be the only process running in the target (or the first one).
In that case, the program may need to be customized for the target system.</p>
</li>
<li>
<p>Tricks to finely control the memory layout of a Rust program. You'll learn about linkers, linker
scripts and about the Rust features that let you control a bit of the ABI of Rust programs.</p>
</li>
<li>
<p>A trick to implement default functionality that can be statically overridden (no runtime cost).</p>
</li>
</ul>
<h2><a class="header" href="#target-audience" id="target-audience">Target audience</a></h2>
<p>This book mainly targets to two audiences:</p>
<ul>
<li>
<p>People that wish to bootstrap bare metal support for an architecture that the ecosystem doesn't
yet support (e.g. Cortex-R as of Rust 1.28), or for an architecture that Rust just gained support
for (e.g. maybe Xtensa some time in the future).</p>
</li>
<li>
<p>People that are curious about the unusual implementation of <em>runtime</em> crates like <a href="https://crates.io/crates/cortex-m-rt"><code>cortex-m-rt</code></a>,
<a href="https://crates.io/crates/msp430-rt"><code>msp430-rt</code></a> and <a href="https://crates.io/crates/riscv-rt"><code>riscv-rt</code></a>.</p>
</li>
</ul>
<h2><a class="header" href="#requirements" id="requirements">Requirements</a></h2>
<p>This book is self contained. The reader doesn't need to be familiar with the
Cortex-M architecture, nor is access to a Cortex-M microcontroller needed -- all
the examples included in this book can be tested in QEMU. You will, however,
need to install the following tools to run and inspect the examples in this
book:</p>
<ul>
<li>
<p>All the code in this book uses the 2018 edition. If you are not familiar with
the 2018 features and idioms check the <a href="https://rust-lang-nursery.github.io/edition-guide/"><code>edition guide</code></a>.</p>
</li>
<li>
<p>Rust 1.31 or a newer toolchain PLUS ARM Cortex-M compilation support.</p>
</li>
<li>
<p><a href="https://github.com/japaric/cargo-binutils"><code>cargo-binutils</code></a>. v0.1.4 or newer.</p>
</li>
<li>
<p><a href="https://crates.io/crates/cargo-edit"><code>cargo-edit</code></a>.</p>
</li>
<li>
<p>QEMU with support for ARM emulation. The <code>qemu-system-arm</code> program must be
installed on your computer.</p>
</li>
<li>
<p>GDB with ARM support.</p>
</li>
</ul>
<h3><a class="header" href="#example-setup" id="example-setup">Example setup</a></h3>
<p>Instructions common to all OSes</p>
<pre><code class="language-console">$ # Rust toolchain
$ # If you start from scratch, get rustup from https://rustup.rs/
$ rustup default stable

$ # toolchain should be newer than this one
$ rustc -V
rustc 1.31.0 (abe02cefd 2018-12-04)

$ rustup target add thumbv7m-none-eabi

$ # cargo-binutils
$ cargo install cargo-binutils

$ rustup component add llvm-tools-preview

</code></pre>
<h4><a class="header" href="#macos" id="macos">macOS</a></h4>
<pre><code class="language-console">$ # arm-none-eabi-gdb
$ # you may need to run `brew tap Caskroom/tap` first
$ brew cask install gcc-arm-embedded

$ # QEMU
$ brew install qemu
</code></pre>
<h4><a class="header" href="#ubuntu-1604" id="ubuntu-1604">Ubuntu 16.04</a></h4>
<pre><code class="language-console">$ # arm-none-eabi-gdb
$ sudo apt install gdb-arm-none-eabi

$ # QEMU
$ sudo apt install qemu-system-arm
</code></pre>
<h4><a class="header" href="#ubuntu-1804-or-debian" id="ubuntu-1804-or-debian">Ubuntu 18.04 or Debian</a></h4>
<pre><code class="language-console">$ # gdb-multiarch -- use `gdb-multiarch` when you wish to invoke gdb
$ sudo apt install gdb-multiarch

$ # QEMU
$ sudo apt install qemu-system-arm
</code></pre>
<h4><a class="header" href="#windows" id="windows">Windows</a></h4>
<ul>
<li>
<p><a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads">arm-none-eabi-gdb</a>.
The GNU Arm Embedded Toolchain includes GDB.</p>
</li>
<li>
<p><a href="https://www.qemu.org/download/#windows">QEMU</a></p>
</li>
</ul>
<h2><a class="header" href="#installing-a-toolchain-bundle-from-arm-optional-step-tested-on-ubuntu-1804" id="installing-a-toolchain-bundle-from-arm-optional-step-tested-on-ubuntu-1804">Installing a toolchain bundle from ARM (optional step) (tested on Ubuntu 18.04)</a></h2>
<ul>
<li>With the late 2018 switch from
<a href="https://rust-embedded.github.io/blog/2018-08-2x-psa-cortex-m-breakage/">GCC's linker to LLD</a> for Cortex-M 
microcontrollers, <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads">gcc-arm-none-eabi</a> is no longer 
required.  But for those wishing to use the toolchain 
anyway, install from <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads">here</a> and follow the steps outlined below:</li>
</ul>
<pre><code class="language-console">$ tar xvjf gcc-arm-none-eabi-8-2018-q4-major-linux.tar.bz2
$ mv gcc-arm-none-eabi-&lt;version_downloaded&gt; &lt;your_desired_path&gt; # optional
$ export PATH=${PATH}:&lt;path_to_arm_none_eabi_folder&gt;/bin # add this line to .bashrc to make persistent
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        
                            <a rel="next" href="smallest-no-std.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
                    <a rel="next" href="smallest-no-std.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
